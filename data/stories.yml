version: "2.0"
stories:
  # PIAF 1
  - story: get_started, PIAF 1 theme ok
    steps:
      - intent: phrase_presentation
      - action: utter_deactivate_text
      - action: utter_get_started
      - action: utter_get_started_2
      - action: action_send_tree
      - intent: choose_theme
      - action: utter_ask_question
      - action: utter_activate_text
      - intent: nlu_fallback
      - action: utter_deactivate_text
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_1: true
          - ask_piaf_1_ok: true
          - ask_piaf_2: false
      - action: utter_satisfaction
      - checkpoint: check_satisfaction

  - story: get_started, PIAF 1 theme ok but no satisfaction, sub theme ok
    steps:
      - intent: phrase_presentation
      - action: utter_deactivate_text
      - action: utter_get_started
      - action: utter_get_started_2
      - action: action_send_tree
      - intent: choose_theme
      - action: utter_ask_question
      - action: utter_activate_text
      - intent: nlu_fallback
      - action: utter_deactivate_text
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_1: true
          - ask_piaf_1_ok: true
          - ask_piaf_2: false
      - action: utter_satisfaction
      - intent: satisfaction_deny
      - action: utter_rephrase_piaf_1
      - action: action_send_tree
      - intent: choose_sub_theme
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_1: true
          - ask_piaf_1_ok: true
          - ask_piaf_2: false
      - action: utter_satisfaction
      - checkpoint: check_satisfaction

  - story: get_started, PIAF 1 theme ok but no satisfaction, sub theme ok but no satisfaction
    steps:
      - intent: phrase_presentation
      - action: utter_deactivate_text
      - action: utter_get_started
      - action: utter_get_started_2
      - action: action_send_tree
      - intent: choose_theme
      - action: utter_ask_question
      - action: utter_activate_text
      - intent: nlu_fallback
      - action: utter_deactivate_text
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_1: true
          - ask_piaf_1_ok: true
          - ask_piaf_2: false
      - action: utter_satisfaction
      - intent: satisfaction_deny
      - action: utter_rephrase_piaf_1
      - action: action_send_tree
      - intent: choose_sub_theme
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_1: true
          - ask_piaf_1_ok: true
          - ask_piaf_2: false
      - action: utter_satisfaction
      - intent: satisfaction_deny
      - action: action_send_tree
      - intent: choose_directory
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_1: true
          - ask_piaf_1_ok: true
          - ask_piaf_2: false
      - action: utter_satisfaction
      - checkpoint: check_satisfaction

  - story: get_started, PIAF 1 sub-theme ok
    steps:
      - intent: phrase_presentation
      - action: utter_deactivate_text
      - action: utter_get_started
      - action: utter_get_started_2
      - action: action_send_tree
      - intent: choose_theme
      - action: utter_ask_question
      - action: utter_activate_text
      - intent: nlu_fallback
      - action: utter_deactivate_text
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_1: true
          - ask_piaf_1_ok: false
          - sub_theme: null
      - action: utter_rephrase_piaf_1
      - action: action_send_tree
      - intent: choose_sub_theme
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_1: true
          - ask_piaf_1_ok: true
          - ask_piaf_2: false
      - action: utter_satisfaction
      - checkpoint: check_satisfaction

  - story: get_started, PIAF 1 directory ok
    steps:
      - intent: phrase_presentation
      - action: utter_deactivate_text
      - action: utter_get_started
      - action: utter_get_started_2
      - action: action_send_tree
      - intent: choose_theme
      - action: utter_ask_question
      - action: utter_activate_text
      - intent: nlu_fallback
      - action: utter_deactivate_text
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_1: true
          - ask_piaf_1_ok: false
          - sub_theme: null
      - action: utter_rephrase_piaf_1
      - action: action_send_tree
      - intent: choose_sub_theme
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_1: true
          - ask_piaf_1_ok: false
          - sub_theme: true
          - directory: null
      - action: action_send_tree
      - intent: choose_directory
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_1: true
          - ask_piaf_1_ok: true
          - ask_piaf_2: false
      - action: utter_satisfaction
      - checkpoint: check_satisfaction

  - story: get_started, PIAF 1 not OK
    steps:
      - intent: phrase_presentation
      - action: utter_deactivate_text
      - action: utter_get_started
      - action: utter_get_started_2
      - action: action_send_tree
      - intent: choose_theme
      - action: utter_ask_question
      - action: utter_activate_text
      - intent: nlu_fallback
      - action: utter_deactivate_text
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_1: true
          - ask_piaf_1_ok: false
          - sub_theme: null
      - action: utter_rephrase_piaf_1
      - action: action_send_tree
      - intent: choose_sub_theme
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_1: true
          - ask_piaf_1_ok: false
          - sub_theme: true
          - directory: null
      - action: action_send_tree
      - intent: choose_directory
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_1: true
          - ask_piaf_1_ok: false
          - ask_piaf_2: false
          - directory: true
      - checkpoint: begin_piaf_2

  # PIAF 2
  - story: PIAF 2 Ok
    steps:
      - checkpoint: begin_piaf_2
      - slot_was_set:
        - ask_piaf_1: true
        - ask_piaf_2: false
      - action: utter_rephrase_piaf_2
      - action: utter_activate_text
      - intent: nlu_fallback
      - action: utter_deactivate_text
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_2: true
          - ask_piaf_2_ok: true
      - action: utter_satisfaction
      - checkpoint: check_satisfaction

  - story: PIAF 2 not ok, sub theme & directory & sub dir
    steps:
      - checkpoint: begin_piaf_2
      - slot_was_set:
        - ask_piaf_1: true
        - ask_piaf_2: false
      - action: utter_rephrase_piaf_2
      - action: utter_activate_text
      - intent: nlu_fallback
      - action: utter_deactivate_text
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_2: true
          - ask_piaf_2_ok: false
          - directory: true
          - send_cards: false
      - action: utter_rephrase_piaf_3
      - action: action_send_tree
      - slot_was_set:
          - send_cards: false
      - intent: choose_sub_directory
      - action: action_send_tree
      - action: utter_satisfaction
      - checkpoint: check_satisfaction

  - story: PIAF 2 not ok, sub theme & directory & cards
    steps:
      - checkpoint: begin_piaf_2
      - slot_was_set:
        - ask_piaf_1: true
        - ask_piaf_2: false
      - action: utter_rephrase_piaf_2
      - action: utter_activate_text
      - intent: nlu_fallback
      - action: utter_deactivate_text
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_2: true
          - ask_piaf_2_ok: false
          - directory: true
          - send_cards: false
      - action: utter_rephrase_piaf_3
      - action: action_send_tree
      - slot_was_set:
          - send_cards: true
      - action: utter_satisfaction
      - checkpoint: check_satisfaction

  - story: PIAF 2 not ok, sub theme & not directory & sub dir
    steps:
      - checkpoint: begin_piaf_2
      - slot_was_set:
        - ask_piaf_1: true
        - ask_piaf_2: false
      - action: utter_rephrase_piaf_2
      - action: utter_activate_text
      - intent: nlu_fallback
      - action: utter_deactivate_text
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_2: true
          - ask_piaf_2_ok: false
          - sub_theme: true
          - directory: null
      - action: utter_rephrase_piaf_3
      - action: action_send_tree
      - intent: choose_directory
      - action: action_send_tree
      - slot_was_set:
          - send_cards: false
      - intent: choose_sub_directory
      - action: action_send_tree
      - action: utter_satisfaction
      - checkpoint: check_satisfaction

  - story: PIAF 2 not ok, sub theme & not directory & cards
    steps:
      - checkpoint: begin_piaf_2
      - slot_was_set:
        - ask_piaf_1: true
        - ask_piaf_2: false
      - action: utter_rephrase_piaf_2
      - action: utter_activate_text
      - intent: nlu_fallback
      - action: utter_deactivate_text
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_2: true
          - ask_piaf_2_ok: false
          - sub_theme: true
          - directory: null
      - action: utter_rephrase_piaf_3
      - action: action_send_tree
      - intent: choose_directory
      - action: action_send_tree
      - slot_was_set:
          - send_cards: true
      - action: utter_satisfaction
      - checkpoint: check_satisfaction

  - story: PIAF 2 not ok, not sub theme & not directory & sub dir
    steps:
      - checkpoint: begin_piaf_2
      - slot_was_set:
        - ask_piaf_1: true
        - ask_piaf_2: false
      - action: utter_rephrase_piaf_2
      - action: utter_activate_text
      - intent: nlu_fallback
      - action: utter_deactivate_text
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_2: true
          - ask_piaf_2_ok: false
          - sub_theme: null
      - action: utter_rephrase_piaf_3
      - action: action_send_tree
      - intent: choose_sub_theme
      - action: action_send_tree
      - intent: choose_directory
      - action: action_send_tree
      - slot_was_set:
          - send_cards: false
      - intent: choose_sub_directory
      - action: action_send_tree
      - action: utter_satisfaction
      - checkpoint: check_satisfaction

  - story: PIAF 2 not ok, not sub theme & not directory & cards
    steps:
      - checkpoint: begin_piaf_2
      - slot_was_set:
        - ask_piaf_1: true
        - ask_piaf_2: false
      - action: utter_rephrase_piaf_2
      - action: utter_activate_text
      - intent: nlu_fallback
      - action: utter_deactivate_text
      - action: action_ask_piaf
      - slot_was_set:
          - ask_piaf_2: true
          - ask_piaf_2_ok: false
          - sub_theme: null
      - action: utter_rephrase_piaf_3
      - action: action_send_tree
      - intent: choose_sub_theme
      - action: action_send_tree
      - intent: choose_directory
      - action: action_send_tree
      - slot_was_set:
          - send_cards: true
      - action: utter_satisfaction
      - checkpoint: check_satisfaction

  # SATISFACTION
  - story: Handle Satisfcation OK
    steps:
      - checkpoint: check_satisfaction
      - slot_was_set:
          - ask_piaf_1: true
      - intent: satisfaction_affirm
      - action: utter_other_question
      - checkpoint: check_other_question

  - story: Handle Satisfcation NOT OK only PIAF 1
    steps:
      - checkpoint: check_satisfaction
      - slot_was_set:
          - ask_piaf_1: true
      - intent: satisfaction_deny
      - slot_was_set:
        - ask_piaf_2: false
      - checkpoint: begin_piaf_2

  - story: Handle Satisfcation NOT OK only PIAF 1 & PIAF 2
    steps:
      - checkpoint: check_satisfaction
      - slot_was_set:
          - ask_piaf_1: true
      - intent: satisfaction_deny
      - slot_was_set:
        - ask_piaf_2: true
      - action: utter_ask_agent
      - checkpoint: check_ask_agent

  # CONTACT AGENT
  - story: Handle NOT contact agent
    steps:
      - checkpoint: check_ask_agent
      - intent: no_ask_agent
      - action: utter_goodbye_service_public

  - story: Handle contact agent
    steps:
      - checkpoint: check_ask_agent
      - intent: ask_agent
      - action: utter_goodbye_service_public

  # OTHER QUESTION
  - story: Handle not other Question
    steps:
      - checkpoint: check_other_question
      - intent: no_other_question
      - action: utter_goodbye_service_public
      - action: action_restart

  - story: Handle Other Question
    steps:
      - checkpoint: check_other_question
      - intent: other_question
      - action: action_restart
      - action: utter_restart
